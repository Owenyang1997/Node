# Mysql
## 索引
### 索引原理
数据库如何查找我们所需的数据呢？如果没有索引，会进行全表扫描，这样如果数据表数据很大，会有很多次I/O操作，磁盘I/O会大大降低性能。减少I/O操作引入了索引。底层使用B+树，将索引列加载到内存，数据全部在叶子节点，可以大大减少I/O操作，并且可以很快定位到我们所需要的数据，只需要很少的I/O操作将我们所需数据加载到内存放回就行，不需要将全表内容加载到内存。  

![d64c460161a6b10b4c9e0378c665a63](https://user-images.githubusercontent.com/34670345/175211944-c773dcc9-cb24-426c-99e7-482cec78e3cf.jpg)

### 分类
1. 聚集索引：


## 查询性能优化
### 优化数据查询
1. 减少请求的数据量
* 只查询需要的列，不要用select *
* 放回必要的行，使用limmit限制行数
* 使用缓存，缓存重复数据。减少数据库压力
2. 减少服务端扫描的行数
* 使用索引覆盖查询

### 重构查询方式
1. 切分大查询
* 一个大查询一次执行的话，锁住很多数据表，阻塞很多小的查询。
2. 分解大连接查询
将一个大连接查询分解成对每个表的单表查询，然后在应用程序中进行关联，这样做的好处有：
* 让缓存更高效，如果是大连接查询，缓存的数据会因一张表的内容改变而失效，但是，单表查询数据，缓存数据粒度很细。数据有效性更高。
* 可以减少锁的竞争。
* 在应用层进行连接，可以更容易对数据库进行拆分。

### 分表
1. 水平切分，可以使用id进行hash,将不同数据分布在集群的不同节点上，从而减轻对单个数据库查询的压力。
2. 垂直切分，将一张表按照列切分为多张表，通常是按照列的关系密集关系进行切分，例如将电商数据表切分为商品表和用户表。
